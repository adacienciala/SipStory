### API Endpoint Test Suite
### POST /api/tasting-notes

@baseUrl = http://localhost:3000/api/tasting-notes

### AUTHENTICATION: 
### 1. Run the login request in auth.http to get an access token
### 2. Copy the access_token from the response and paste it below
@accessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vMTI3LjAuMC4xOjU0MzIxL2F1dGgvdjEiLCJzdWIiOiI3Njk4MWZlNC0xZDdhLTQzZmEtYTg3OS0xYzEwMTIwNWM0NGIiLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzYyMDk2OTYxLCJpYXQiOjE3NjIwOTMzNjEsImVtYWlsIjoidGVzdEB0ZXN0LmNvbSIsInBob25lIjoiIiwiYXBwX21ldGFkYXRhIjp7InByb3ZpZGVyIjoiZW1haWwiLCJwcm92aWRlcnMiOlsiZW1haWwiXX0sInVzZXJfbWV0YWRhdGEiOnsiZW1haWxfdmVyaWZpZWQiOnRydWV9LCJyb2xlIjoiYXV0aGVudGljYXRlZCIsImFhbCI6ImFhbDEiLCJhbXIiOlt7Im1ldGhvZCI6InBhc3N3b3JkIiwidGltZXN0YW1wIjoxNzYyMDkzMzYxfV0sInNlc3Npb25faWQiOiJlZGYzOWM0Yi05NzQyLTQyZDctYTlkMC05ZjEwZGQ4ODVhYzMiLCJpc19hbm9ueW1vdXMiOmZhbHNlfQ.z4dF0yr-OIv12fqrKc3Sgz4KqaybUM9xzhqVlp8KzoY

### SETUP: First, you need to create a blend using POST /api/blends
### Save the returned blend_id and use it in the tests below

@testBlendId = 85e8ef56-f4b1-47b8-a9f6-f58a0dd53d16
@nonExistentBlendId = 00000000-0000-0000-0000-000000000001

### Test 1: Create tasting note with all fields
### Expected: 201 Created with complete tasting note data
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "umami": 5,
  "bitter": 2,
  "sweet": 4,
  "foam": 5,
  "notes_koicha": "Rich umami, creamy texture, minimal bitterness",
  "notes_milk": "Smooth and balanced, complements milk well",
  "price_pln": 150,
  "purchase_source": "https://ippodo-tea.co.jp"
}

### Test 2: Create tasting note with only required fields
### Expected: 201 Created with null values for optional fields
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 4
}

### Test 3: Missing required field (blend_id)
### Expected: 400 Bad Request with validation error details
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "overall_rating": 5
}

### Test 4: Missing required field (overall_rating)
### Expected: 400 Bad Request with validation error details
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}"
}

### Test 5: Non-existent blend_id
### Expected: 404 Not Found
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{nonExistentBlendId}}",
  "overall_rating": 5
}

### Test 6: Invalid UUID format for blend_id
### Expected: 400 Bad Request
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "not-a-valid-uuid",
  "overall_rating": 5
}

### Test 7: Invalid rating value (< 1)
### Expected: 400 Bad Request
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 0
}

### Test 8: Invalid rating value (> 5)
### Expected: 400 Bad Request
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 6
}

### Test 9: Invalid optional rating value (umami > 5)
### Expected: 400 Bad Request
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "umami": 10
}

### Test 10: Negative price
### Expected: 400 Bad Request
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "price_pln": -10
}

### Test 11: Invalid field type (overall_rating as string)
### Expected: 400 Bad Request
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": "five"
}

### Test 12: Invalid JSON format
### Expected: 400 Bad Request
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{invalid json}

### Test 13: Create multiple notes for same blend (should succeed)
### Expected: 201 Created (different notes for same blend allowed)
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 4,
  "umami": 4,
  "notes_koicha": "Second tasting of the same blend"
}

### Test 14: Create with null values for optional fields
### Expected: 201 Created
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 3,
  "umami": null,
  "bitter": null,
  "sweet": null,
  "foam": null,
  "notes_koicha": null,
  "notes_milk": null,
  "price_pln": null,
  "purchase_source": null
}

### Test 15: Notes max length (5000 chars)
### Expected: 201 Created
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "notes_koicha": "Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to reach 5000 chars)"
}

### Test 16: Notes exceeding max length
### Expected: 400 Bad Request
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "notes_koicha": "Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)"
}
