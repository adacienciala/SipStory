### API Endpoint Test Suite
### POST /api/tasting-notes

@endpointUrl = {{baseUrl}}/api/tasting-notes

### AUTHENTICATION: 
### 1. Run the login request in auth.http to get an access token
### 2. Update the accessToken in http-client.private.env.json (gitignored)
### 3. Or set it directly below for quick testing

### SETUP: Create a blend using POST /api/blends first
### Save the returned blend_id in http-client.private.env.json

### Test 1: Create tasting note with all fields
### Expected: 201 Created with complete tasting note data
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "umami": 5,
  "bitter": 2,
  "sweet": 4,
  "foam": 5,
  "notes_koicha": "Rich umami, creamy texture, minimal bitterness",
  "notes_milk": "Smooth and balanced, complements milk well",
  "price_pln": 150,
  "purchase_source": "https://ippodo-tea.co.jp"
}

### Test 2: Create tasting note with only required fields
### Expected: 201 Created with null values for optional fields
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 4
}

### Test 3: Missing required field (blend_id)
### Expected: 400 Bad Request with validation error details
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "overall_rating": 5
}

### Test 4: Missing required field (overall_rating)
### Expected: 400 Bad Request with validation error details
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}"
}

### Test 5: Non-existent blend_id
### Expected: 404 Not Found
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{nonExistentBlendId}}",
  "overall_rating": 5
}

### Test 6: Invalid UUID format for blend_id
### Expected: 400 Bad Request
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "not-a-valid-uuid",
  "overall_rating": 5
}

### Test 7: Invalid rating value (< 1)
### Expected: 400 Bad Request
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 0
}

### Test 8: Invalid rating value (> 5)
### Expected: 400 Bad Request
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 6
}

### Test 9: Invalid optional rating value (umami > 5)
### Expected: 400 Bad Request
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "umami": 10
}

### Test 10: Negative price
### Expected: 400 Bad Request
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "price_pln": -10
}

### Test 11: Invalid field type (overall_rating as string)
### Expected: 400 Bad Request
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": "five"
}

### Test 12: Invalid JSON format
### Expected: 400 Bad Request
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{invalid json}

### Test 13: Create multiple notes for same blend (should succeed)
### Expected: 201 Created (different notes for same blend allowed)
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 4,
  "umami": 4,
  "notes_koicha": "Second tasting of the same blend"
}

### Test 14: Create with null values for optional fields
### Expected: 201 Created
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 3,
  "umami": null,
  "bitter": null,
  "sweet": null,
  "foam": null,
  "notes_koicha": null,
  "notes_milk": null,
  "price_pln": null,
  "purchase_source": null
}

### Test 15: Notes max length (5000 chars)
### Expected: 201 Created
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "notes_koicha": "Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to reach 5000 chars)"
}

### Test 16: Notes exceeding max length
### Expected: 400 Bad Request
POST {{endpointUrl}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "blend_id": "{{testBlendId}}",
  "overall_rating": 5,
  "notes_koicha": "Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)Lorem ipsum dolor sit amet, consectetur adipiscing elit... (repeat to exceed 5000 chars - would need actual 5001+ char string here)"
}
