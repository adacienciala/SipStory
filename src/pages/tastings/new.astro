---
import BackButton from "../../components/BackButton.astro";
import { TastingForm } from "../../components/tasting-form/TastingForm";
import Layout from "../../layouts/Layout.astro";

export const prerender = false;

// Check if user is authenticated
const supabase = Astro.locals.supabase;
const {
  data: { user },
} = await supabase.auth.getUser();

if (!user) {
  return Astro.redirect("/login");
}
---

<Layout title="New Tasting Note">
  <div class="container mx-auto max-w-2xl px-4 py-8">
    <div class="mb-6">
      <BackButton text="Back to Dashboard" />
    </div>
    <h1 class="mb-8 text-3xl font-bold text-gray-900" data-testid="page-heading">New Tasting Note</h1>
    <TastingForm client:load />
  </div>
</Layout>
